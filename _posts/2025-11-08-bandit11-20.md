---
layout: post
title: Bandit 11 - 20
category: OverTheWire
---

WORK IN PROGRESS

Alright, so logging into **Bandit 11**

We see we're dealing with more data.  

Here are the specifications:  
> "All lowercase (a-z) and uppercase (A-Z) letters have been rotated by 13 positions"

So this one's definitely more difficult than before.  

Since all the letters have been rotated by 13 positions, it sounds like we're dealing with more of a cipher.  

More specifically, the **ROT13 cipher**, which replaces each letter with the 13th letter after it.

It seems like in order to decode it, we will need to use the **tr command** (translate command).  

Okay, so with this particular cipher, they translated the standard alphabet set (`A-Z` and `a-z`)  
to a different set with a 13-letter offset, which looks like  
this set (`N-Z` and `n-z`).  

So `A-Z` and `a-z` == `N-Z` and `n-z` in this case, so using the translate command, we will  
tell it to map each letter back to its unrotated letter.

So first, we'll `cat` the data and pipe the output into the translate command and map the two sets together, which looks like:

```bash
cat data.txt | tr 'a-zA-Z' 'n-za-mN-ZA-M'
```

which will give us the flag.

---

### BANDIT 12

Okay, apparently the password is stored in the file `data.txt`, and it's a **hexdump file** that has undergone numerous compressions.  

Anyway, so what seems to need to be done is we need to create a directory to work in (which it's saying to do in temp, probably to leave no trace).  

So using the `mktemp -d` command (making a directory in the temp folder).  

After making that directory, we need to move there to work there, so changing directories with `cd` lets us move there.  

Now we can copy the data file to this directory (we have more permissions in this directory).  

Using the copy command (`cp`), we can:

```bash
cp ~/data.txt .
```

(which copies it to the current directory we are in).  

Then let's rename the `data.txt` file to a new file named **hexdump** using the move command (`mv`):

```bash
mv data.txt hexdump
```

Then we need to dump the contents into a new file and work from there.  

Using the `xxd` command with the `-r` flag, we can reverse the hexdump into a new file.  

When we get the data, it looks scrambled (probably because it's compressed).  

---

Okay, now here's the fun part.  
So in the hexdump file it tells us the signature of the type of compression method that was used in the header, so using `head` we see `1f8b 08`,  
which means it's **gzip compressed**.  

For gzip compressed files, the header is `\x1F\x8B\x08`.  

In order to decompress, we need to make the data file a gzip file (that's because it's compressed into a gzip file, so we change the name to `data.gz` using the `mv` command) via:

```bash
mv data data.gz
```

Then decompress it using:

```bash
gzip -d data.gz
```

But when we read it, we notice that the file is not fully decompressed, so doing the same thing we did before, we will `xxd` the file, and the first few bytes that pop up is a **bz2 file**.  

When looking up `425a 68`, we see it's a **bzip2 file (version 2)**.  

So we change it to a bzip2 file and then decompress it again:

```bash
mv data data.bz2
bzip2 -d data.bz2
```

Then we `cat` it and notice it's still compressed, so let's read the hex version of it again:

```bash
xxd data
```

First few bytes we see is `1f8b 08`,  
which is another **gzip file**.  

oooo we're getting close lol.  

Let's do it again.  

What we get is an endless abyss of code lol, no worries.  

Instead, do:

```bash
xxd data | head
```

(`head` only prints the first 10 lines of code).  

And when we use the command `file` on the file we see it's a **tar archive**.  

So we change the file to a tar file and extract it using:

```bash
tar -xf data.tar
```

When we list, we get out a file called `data5.bin`.  

So we extract the bin file again and we get `data6.bin`.  

Let's read the header — another **bzip2 file**.  

So when we convert it and decompress it, we get another **tar archive** (I know because I used the `file` command).  

Now we get a `data8.bin` file which is a **gzipped compressed file** — now let's decompress it.

---

**AND AFTER A CENTURY WE FINALLY GOT THE FLAG!**
```
BANDIT 13
